---
title: '"D√©buter" avec <i class="fab fa-r-project glow"></i>'
subtitle: "En Commen√ßant par le D√©but ..."
author: "Micka√´l Canouil, *Ph.D.*"
date: 'Mercredi 7 Octobre 2020 (MeetUp)'
knit: (function(inputFile, encoding) { rmarkdown::render(inputFile, encoding = encoding, output_dir = "docs") })
output: 
  mctemplates::ioslides_presentation:
    logo: images/rlille_rconsortium_textwhite.png
    wide: true
---

<!-- <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css"/> -->

<style>
blockquote {
  background: #333333;
  color: #ffffff;
  font-style: italic;
  border-left: 5px solid #fafafa;
  margin: 1.5em 10px;
  padding: 0.5em 1em;
}
</style>

```{r setup, include = FALSE}
options(stringsAsFactors = FALSE, width = 80)

### Load packages and functions
library(here)
library(knitr)
# library(carbonate)

### Set knitr rmarkdown chunk options
opts_chunk$set(
  include = TRUE,
  echo = FALSE,
  warning = FALSE,
  message = FALSE,
  eval = TRUE,
  tidy = FALSE,
  crop = TRUE,
  autodep = FALSE,
  dpi = 120,
  width = getOption("width"),
  results = "asis",
  comment = "#>",
  fig.align = "center",
  fig.path = "images/"
)
```

## Les d√©buts avec <i class="fab fa-r-project"></i>

```{r, out.width = "420pt", out.height = ""}
if (!file.exists(here("images", "r_first_ahorst.png"))) {
  download.file(
    url = "https://github.com/allisonhorst/stats-illustrations/raw/master/rstats-artwork/r_first_then.png", 
    destfile = here("images", "r_first_ahorst.png")
  )
}
include_graphics(here("images", "r_first_ahorst.png"))
```

## <i class="fab fa-r-project"></i> ([Thomas Lin Pedersen <i class="fab fa-twitter"></i>](https://twitter.com/thomasp85/status/961553618196418560))

```{r, out.width = "100%"}
include_graphics(here("images", "R-startup.svg"))
```

## <i class="fab fa-r-project"></i> ([Thomas Lin Pedersen <i class="fab fa-twitter"></i>](https://twitter.com/thomasp85/status/961553618196418560)) {.flexbox .vcenter}

`r include_graphics(here("images", "shocked-face-with-exploding-head_1f92f.png"))`

## <i class="fab fa-r-project"></i> ([Thomas Lin Pedersen <i class="fab fa-twitter"></i>](https://twitter.com/thomasp85/status/961553618196418560))

```{r, out.width = "100%"}
include_graphics(here("images", "R-startup-all.svg"))
```

# Sauvegarder</br>le code</br>...</br>pas l'environnement !

## Sauvegarder le code

Les scripts :
 
* "*standards*" dans un fichier `.R`

* "*Rmarkdown*" dans un fichier `.Rmd`

Les "donn√©es" :

* un objet dans un `.rds`

* une liste d'objet dans un `.Rdata`

# Utiliser un IDE | `r include_graphics(here("images", "nerd-face_1f913.png"))`</br>("Integrated Development Environment")

## Utiliser un IDE

* RStudio :  
    https://www.rstudio.com/products/rstudio/download/#download

* Emacs + ESS :  
    https://ess.r-project.org

* vim + Nvim-R :  
    https://medium.com/free-code-camp/turning-vim-into-an-r-ide-cd9602e8c217

* Visual Studio + RTVS :  
    https://docs.microsoft.com/en-us/visualstudio/rtvs
    
# Faire</br>*Table Rase*</br>√†</br>Chaque D√©marrage !

## Faire *table rase* √† chaque d√©marrage !

```{r}
include_graphics(here("images", "R-startup-session.svg"))
```

## Faire *table rase* √† chaque d√©marrage !

```{r}
include_graphics(here("images", "R-startup-session-zoom.svg"))
```

## Faire *table rase* √† chaque d√©marrage !

Lorsque vous quittez <i class="fab fa-r-project"></i> :

* Ne pas enregistrer votre espace de travail (*workspace*<sup>\*</sup>)&nbsp;!

Lorsque vous d√©marrez <i class="fab fa-r-project"></i> :

* Ne pas charger l'espace de travail sauvegard√© pr√©c√©demment&nbsp;!

<sup>\*</sup> Le *workspace* est automatiquement sauvegard√©/charg√© via un fichier nomm√© `.Rdata` (l√† o√π s'execute <i class="fab fa-r-project"></i>).

## Faire *table rase* ! | Dans Windows

```{r, out.width = "", out.height = "425px"}
include_graphics(here("images", "rwindows.png"))
```

## Faire *table rase* ! | Dans RStudio (*Tools > Global options*)

```{r, out.width = "", out.height = "425px"}
include_graphics(here("images", "rstudio.png"))
```

## Faire *table rase* ! {.columns-2}

### Dans un Terminal

```{r, eval = FALSE}
x <- carbon$new("R --no-save --no-restore-data")
x$template <- "cobalt"
x$carbonate(file = here("images", "terminal.svg"))
x$stop_all()
# x$uri()
```
```{r}
include_graphics(here("images", "terminal.svg"))
```

### `.bash_profile`

```{r, eval = FALSE}
x <- carbon$new("alias R='R --no-save --no-restore-data'")
x$template <- "cobalt"
x$carbonate(file = here("images", "bash_profile.svg"))
x$stop_all()
# x$uri()
```

```{r}
include_graphics(here("images", "bash_profile.svg"))
```

# Comment R√©initialiser <i class="fab fa-r-project"></i> ? | `r include_graphics(here("images", "thinking-face_1f914.png"))`

# Avec</br>`rm(list = ls())`</br>?

# `r include_graphics(here("images", "face-screaming-in-fear_1f631.png"))` {.flexbox .vcenter}

<div class="auto-fadein">

> If the first line of your R script is
> 
> `rm(list = ls())`
> 
> I will come into your office and SET YOUR COMPUTER ON FIRE üî•.
> 
> --- Jenny Bryan

</div>

## Que ne fait pas `rm(list = ls())` ?

* R√©initialiser la session <i class="fab fa-r-project"></i> en cours

* R√©initialiser les `options()`  
    &#x2192; `options(stringsAsFactors = FALSE)`<sup>*</sup>

* R√©initialiser le r√©pertoire de travail  
    `getwd()` &#x2192; `setwd()`

* R√©initialiser les extensions <i class="fab fa-r-project"></i> attach√©es

<sup>\*</sup>Valeur par d√©faut <i class="fab fa-r-project"></i> v4.0.0 ([Kurt Hornik: stringsAsFactors](https://developer.r-project.org/Blog/public/2020/02/16/stringsasfactors/)).

## Mais alors que fait `rm(list = ls())` ?

```{r, eval = FALSE, echo = TRUE}
help(rm)
```

```{r, out.width = "100%"}
include_graphics(here("images", "rm-doc.png"))
```

# Comment r√©initialiser <i class="fab fa-r-project"></i> ? | `r include_graphics(here("images", "thinking-face_1f914.png"))`

# Red√©marrer <i class="fab fa-r-project"></i> ! | `r include_graphics(here("images", "grinning-face-with-one-large-and-one-small-eye_1f92a.png"))`

## R√©initialiser <i class="fab fa-r-project"></i>

* Dans une console <i class="fab fa-r-project"></i>
    * Via le raccourci `Ctrl+D` 
    * Via la fonction `q()` dans une console <i class="fab fa-r-project"></i>

## R√©initialiser <i class="fab fa-r-project"></i>

* Dans RStudio :
    * Via le raccourci `Ctrl+Shift+F10`
    * Via le menu  
        ```{r, out.width = "", out.height = "375px"}
        include_graphics(here("images", "restartr.png"))
        ```
        
# D√©marrage de <i class="fab fa-r-project"></i> | `.Renviron` & `.Rprofile`

## `.Renviron` & `.Rprofile`

* `.Renviron` - contient des variables d'environnement
* `.Rprofile` - contient du code <i class="fab fa-r-project"></i>

```{r, out.width = "", out.height = "400px"}
include_graphics(here("images", "R-startup-dotfiles.svg"))
```

## `.Renviron`

* `.Renviron` - contient des variables d'environnement

```{r}
include_graphics(here("images", "R-startup-environ-zoom.svg"))
```

## `.Renviron`

* `.Renviron` - contient des variables d'environnement

```{r, echo = TRUE, eval = FALSE}
R_MAX_NUM_DLLS=300
GITHUB_PAT=abc123
TZ='Etc/UTC'
R_LIBS_USER=~/R/%p/%v
```

La variable `R_PROFILE_USER` permet de d√©finir √† partir de quel r√©pertoire le `.Rprofile` est charg√©.
```{r, echo = TRUE, eval = FALSE}
R_PROFILE_USER=~/.Rprofile # Par d√©faut
```

## `.Rprofile`

```{r}
include_graphics(here("images", "R-startup-dotfiles.svg"))
```

## `.Rprofile`

```{r}
include_graphics(here("images", "R-startup-profile-zoom.svg"))
```

## Peut-on mettre tout dans `.Rprofile` ?

* D√©finir un d√©p√¥t CRAN
* √âcrire un message d'accueil
* Personnaliser l'invite de commandes
* Modifier les options d'affichage (*p.ex.*, largeur en nombre de caract√®res `options(width = 120)`)
* Charger des extensions <i class="fab fa-r-project"></i> fr√©quemment utilis√©es
* Ajouter des raccourcis et/ou alias √† des fonctions
* ...

<p class="centered" style="font-size:3em;">Mais, **ATTENTION** !</p>

## `.Rprofile` et reproductibilit√©

Ce qui figure dans le fichier `.Rprofile` :

* Ne doit avoir aucune incidence sur un script `.R` ou `.Rmd`
* A pour objectif d'√™tre utilis√© uniquement de fa√ßon interactive (directement dans la console)

```{r}
options(repos = c(CRAN = "https://cran.rstudio.org"))

if (interactive()) {
  options(width = 120)
}
```

## `.Rprofile` et reproductibilit√©

```{r, out.width = "", out.height = "400px"}
include_graphics(here("images", "R-startup-profile.svg"))
```

Le `.Rprofile` est charg√© dans l'environnement √† chaque execution d'un processus R (`Rscript` et `R`).

## Mon `.Rprofile` ([GitHub](https://github.com/mcanouil/mctemplates/blob/master/R/rprofile.R))

```{r, fig.show = "hold", out.width = "49%", out.height = "", out.extra = 'style="display: inline;vertical-align: middle;"'}
include_graphics(c(here("images", "Rprofile_code.png"), here("images", "Rprofile_console.png")))
```

## D√©sactiver les fichiers de d√©marrage

* `--vanilla` - pour d√©sactiver le chargement de **tous les fichiers** de d√©marrage

* `--no-init-file` - pour d√©sactiver le chargement du fichier `.Rprofile`

* `--no-environ` - pour d√©sactiver le chargement du fichier `.Renviron`

# `r include_graphics(here("images", "face-screaming-in-fear_1f631.png"))` {.flexbox .vcenter}

<div class="auto-fadein">

> If the first line of your R script is
> 
> `setwd("C:\Users\jenny\path\that\only\I\have")`
> 
> I will come into your office and SET YOUR COMPUTER ON FIRE üî•.
> 
> --- Jenny Bryan

</div>

# Faisons le Point sur `setwd()` ! | `r include_graphics(here("images", "face-with-uneven-eyes-and-wavy-mouth_1f974.png"))`

## Faisons le Point sur `setwd()` !

```{r, echo = TRUE, eval = FALSE}
library(ggplot2)

### <b>
setwd("/path/to/a/directory/on/my/laptop/data")
### </b>

### <b>
df <- read.delim("data.csv")
### </b>

p <- ggplot(df, aes(x, y)) + geom_point()

### <b>
ggsave("../figs/scatterplot.png")
### </b>
```

## Faisons le Point sur `setwd()` !

```{r, echo = TRUE, eval = FALSE}
library(ggplot2)

### <b>
setwd("/path/to/a/directory/on/my/laptop/data")
### </b>

### <b>
df <- read.delim("data.csv")
### </b>

p <- ggplot(df, aes(x, y)) + geom_point()

### <b>
setwd("/path/to/a/directory/on/my/laptop/figs")
### </b>

### <b>
ggsave("scatterplot.png")
### </b>
```

## Faisons le Point sur `setwd()` !

```{r, out.width = "100%", out.height = ""}
include_graphics(here("images", "setwd_example.png"))
```

## L'extension `here`

```{r, out.width = "100%", out.height = ""}
if (!file.exists(here("images", "here_ahorst.png"))) {
  download.file(
    url = "https://github.com/allisonhorst/stats-illustrations/raw/master/rstats-artwork/here.png", 
    destfile = here("images", "here_ahorst.png")
  )
}
include_graphics(here("images", "here_ahorst.png"))
```

## Utiliser un Mode "Projet" via une IDE

* D√©marrer un projet A :
    1. D√©marre R.
    2. D√©fini le r√©petoire de travail de R comme la racine du projet A.

* Passer d'un projet A √† un project B :
    1. Red√©marre R.
    2. D√©fini le r√©petoire de travail de R comme la racine du projet B.


## Utiliser un Mode "Projet"

* ["What They Forgot to Teach You About R"](https://rstats.wtf/project-oriented-workflow.html) --- Jenny Bryan & Jim Hester

* ["Project-oriented Workflow"](https://www.tidyverse.org/articles/2017/12/workflow-vs-script/) --- Jenny Bryan

## Workflow

```{r, out.width = "100%", out.height = ""}
if (!file.exists(here("images", "workflow_ahorst.jpg"))) {
  download.file(
    url = "https://github.com/allisonhorst/stats-illustrations/raw/master/other-stats-artwork/workflow.jpg", 
    destfile = here("images", "workflow_ahorst.jpg")
  )
}
include_graphics(here("images", "workflow_ahorst.jpg"))
```

# Lectures Utiles {.flexbox .vcenter}

<div class="auto-fadein" style="color:white;font-size:90%;">
* ["Code Smells and Feels"](https://www.youtube.com/watch?v=7oyiPBjLAWY) --- Jenny Bryan

* ["Advanced R"](https://adv-r.hadley.nz/) --- Hadley Wickham

* ["Project-oriented Workflow"](https://www.tidyverse.org/articles/2017/12/workflow-vs-script/) --- Jenny Bryan

* ["R for Data Science"](https://r4ds.had.co.nz/) --- Garrett Grolemund & Hadley Wickham

* ["What They Forgot to Teach You About R"](https://rstats.wtf/) --- Jenny Bryan & Jim Hester
</div>

# <img src="https://avatars1.githubusercontent.com/u/8896044?s=460&v=4" height = "150px" id = "picture"></img> {.flexbox .vcenter}

<div class="columns-2 auto-fadein">
  <a id="social" href="" target="_blank"><i class="fas fa-phone"></i> +33 (0) 374 00 81 29</a> 
    
  <a id="social" href="mailto:mickael.canouil@cnrs.fr" target="_blank"><i class="fas fa-envelope"></i> mickael.canouil@cnrs.fr</a> 

  <a id="social" href="http://mickael.canouil.fr" target="_blank"><i class="fas fa-home"></i> mickael.canouil.fr</a> 

  <a id="social" href="https://www.linkedin.com/in/mickael-canouil" target="_blank"><i class="fab fa-linkedin"></i> mickael-canouil</a> 

  <a id="social" href="https://github.com/mcanouil" target="_blank"><i class="fab fa-github"></i> mcanouil</a> 

  <a id="social" href="https://twitter.com/mickaelcanouil" target="_blank"><i class="fab fa-twitter"></i> @mickaelcanouil</a>
</div>
